---
layout: default
title: "Gobuster"
permalink: /ActiveDiscovery/Gobuster/
nav_order: 3
parent: Active Discovery
---

## Introduction

Gobuster is a brute force directory and DNS subdomain enumeration tool that is significantly faster than dirb as it is a multithreaded tool and contains more options for searching through directories. One benefit for time management that this tool provides is that unlike dirb, it does not recursively search through found directories (which can be seen as a pro or con, depending on your needs).

## Installation

All of the Gobuster installation files are located at [Gobuster](https://github.com/OJ/gobuster), however some prerequisites are needed.

### Prerequisites

Since Gobuster is written in the Go language, it can be run on any system with Go installed.

### Windows and MacOS Go Install

[Go Download](https://golang.org/dl/)

For Windows and MacOS, the installation of the Go language couldn``t be simpler, download the package from the link above that fits your system, and install away.

### Linux Go Install

For most Linux operating systems, the Go language is already listed in their default repositories, and can be installed with the following (shown example is for Debian non-root user, use your distribution equivalent):

    sudo apt-get install golang

### Windows and MacOS GoBuster Install

In windows and MacOS, gobuster can be installed with the following without any additional changes to the PATH:

    go get github.com/OJ/gobuster

### Linux Gobuster Install

To install gobuster in Linux, you can either download the package from the GitHub, extract it, and reconfigure the Go PATH variables, or run the following

    sudo apt-get install gobuster

This will install gobuster and allow it to be run through the CLI directly rather than going through the Go tool.

### Running Gobuster

There are three different modes that gobuster can be run with, dir, dns, and vhost, each come with a separate set of options that allows for customized searches. While there are switches directly related to the different modes of gobuster, there are a few global switches as well that will work in all the modes. The three main global switches that would most likely be used are the –o (output to file), -w (wordlist file), and -t (thread count). While the first two are straight forward, the –t switch allows the user to change the amount of concurrent threads being run by gobuster. By changing the thread count, the speed of the scan can be increased or decreased (10 is the standard, 200 is the max). By using the highest count, the scan will be shorter in duration but may cause some directories to not be found.

In addition to downloaded wordlists, gobuster can also work with a piped wordlist as well. This can be done by providing a stdin to gobuster and using the reference - for the wordlist switch location as seen below.

    hashcat -a 3 --stdout ?l | gobuster dir -u https://mysite.com -w
    Dir

The directory mode for the tool is similar to using dirb to brute force directory names from a wordlist. However, gobuster can be modified to identify directories that give out different status codes. For example, dirb does not report back directories with status code 403 (Forbidden), but it is recognized by gobuster. This can be useful as you now know that a forbidden file is there, but cannot be accessed directly with the current privileges.

<img src="{{site.baseurl}}/assets/img/gobuster_1.png">

Figure 1 - Gobuster directory mode switches

### DNS

The DNS mode for dirbuster is a subdomain enumeration tool (subdomain.domain.com). To use this mode, only the –d (domain name) and –w (wordlist) switches need to be specified, however using the –i (ip address) switch can be helpful as it displays the IP address associated with the subdomain, which may increase the number of potential targets for future enumeration or exploiting.

<img src="{{site.baseurl}}/assets/img/gobuster_2.png">

Figure 2 - Gobuster DNS mode switches

### VHost

The last mode option for gobuster is the virtual host enumeration. This mode allows the user to scan the target for any additional virtual hosts that may be running on the web server.  

<img src="{{site.baseurl}}/assets/img/gobuster_3.png">

Figure 3 - Gobuster VHost mode switches

### Example Usage

For gobuster to run a directory search, only the –u and –w flags need to be specified. Using the OWASPBWA machine as the example target, gobuster will brute force the site and find the first level of directories and pages listed on the site.

<img src="{{site.baseurl}}/assets/img/gobuster_4.png">

Figure 4 - Example of dir mode usage on the OWASP BWA machine

For the DNS scan, we will use the website hackthissite.org. Gobuster seems to have issues pulling in external websites when specifying the domain as an IP address, so a website with a real domain name was used.

<img src="{{site.baseurl}}/assets/img/gobuster_5.png">

Figure 5 - Example of dns mode usage on the website hackthissite.org

From the scan, four subdomains were found. With this information, further enumeration or target analysis can be used to identify the system and processes that might be running on the web server. This scan was tried with various amount of thread counts, and it appears the higher the thread count, the more likely false positives will appear.
